<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate UMAP cluster hulls — hc_cluster_hulls • HPAclusteR</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate UMAP cluster hulls — hc_cluster_hulls"><meta name="description" content="hc_cluster_hulls() computes density-based cluster hulls on UMAP embeddings stored within an AnnDatR object. It identifies subclusters using DBSCAN, estimates density, filters based on cumulative density and fraction limits, and generates concave hulls for each cluster."><meta property="og:description" content="hc_cluster_hulls() computes density-based cluster hulls on UMAP embeddings stored within an AnnDatR object. It identifies subclusters using DBSCAN, estimates density, filters based on cumulative density and fraction limits, and generates concave hulls for each cluster."><meta property="og:image" content="https://buenoalvezm.github.io/HPAclusteR/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">HPAclusteR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/HPAclusteR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/buenoalvezm/HPAclusteR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate UMAP cluster hulls</h1>
      <small class="dont-index">Source: <a href="https://github.com/buenoalvezm/HPAclusteR/blob/master/R/hc_cluster_hulls.R" class="external-link"><code>R/hc_cluster_hulls.R</code></a></small>
      <div class="d-none name"><code>hc_cluster_hulls.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>hc_cluster_hulls()</code> computes density-based cluster hulls on UMAP embeddings stored within an AnnDatR object. It identifies subclusters using DBSCAN, estimates density, filters based on cumulative density and fraction limits, and generates concave hulls for each cluster.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hc_cluster_hulls</span><span class="op">(</span></span>
<span>  <span class="va">AnnDatR</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">300</span>,</span>
<span>  cum_z_lim <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  frac_lim <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  plot_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">AnnDatR</span><span class="op">[[</span><span class="st">"obs"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"UMAP1"</span><span class="op">]</span><span class="op">]</span>, <span class="va">AnnDatR</span><span class="op">[[</span><span class="st">"obs"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"UMAP2"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">AnnDatR</span><span class="op">[[</span><span class="st">"obs"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"UMAP1"</span><span class="op">]</span><span class="op">]</span>, <span class="va">AnnDatR</span><span class="op">[[</span><span class="st">"obs"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"UMAP2"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fl">1.05</span>,</span>
<span>  poly_concavity <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  poly_smoothing <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  relative_bandwidth <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">200</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-anndatr">AnnDatR<a class="anchor" aria-label="anchor" href="#arg-anndatr"></a></dt>
<dd><p>An AnnDatR object containing UMAP embeddings and cluster assignments.</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Number of grid points for density estimation (default is 300).</p></dd>


<dt id="arg-cum-z-lim">cum_z_lim<a class="anchor" aria-label="anchor" href="#arg-cum-z-lim"></a></dt>
<dd><p>Cumulative density limit for filtering (default is 0.95).</p></dd>


<dt id="arg-frac-lim">frac_lim<a class="anchor" aria-label="anchor" href="#arg-frac-lim"></a></dt>
<dd><p>Minimum fraction limit for subcluster inclusion (default is 0.05).</p></dd>


<dt id="arg-plot-range">plot_range<a class="anchor" aria-label="anchor" href="#arg-plot-range"></a></dt>
<dd><p>Range of the plot in the format c(xmin, xmax, ymin, ymax) (default is 1.05 times the min and max of UMAP1 and UMAP2).</p></dd>


<dt id="arg-poly-concavity">poly_concavity<a class="anchor" aria-label="anchor" href="#arg-poly-concavity"></a></dt>
<dd><p>Controls the concavity of the polygons (default is 1). Higher values result in less detailed polygons.</p></dd>


<dt id="arg-poly-smoothing">poly_smoothing<a class="anchor" aria-label="anchor" href="#arg-poly-smoothing"></a></dt>
<dd><p>Controls the smoothing of the polygons (default is 1). Higher values result in less detailed polygons.</p></dd>


<dt id="arg-relative-bandwidth">relative_bandwidth<a class="anchor" aria-label="anchor" href="#arg-relative-bandwidth"></a></dt>
<dd><p>Relative bandwidth for density estimation as a fraction of the plot diagonal (default is 1/200).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>AnnDatR object with UMAP cluster hulls within the AnnDatR object.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Calculate UMAP cluster hulls on an AnnDatR object after UMAP and clustering</span></span></span>
<span class="r-in"><span><span class="va">adata_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="hc_pca.html">hc_pca</a></span><span class="op">(</span><span class="va">example_adata</span>, components <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">adata_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="hc_distance.html">hc_distance</a></span><span class="op">(</span><span class="va">adata_res</span>, components <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">adata_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="hc_snn.html">hc_snn</a></span><span class="op">(</span><span class="va">adata_res</span>, neighbors <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Building SNN based on a provided distance matrix</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing SNN</span>
<span class="r-in"><span><span class="va">adata_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="hc_cluster_consensus.html">hc_cluster_consensus</a></span><span class="op">(</span><span class="va">adata_res</span>, resolution <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration: 0 *** value: 948.279</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration: 1 *** value: 70.5063</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration: 2 *** value: 22.246</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration: 3 *** value: 22.2447</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration: 4 *** value: 22.2447</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Minimum: 22.2447</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Joining with `by = join_by(cons_cluster)`</span>
<span class="r-in"><span><span class="va">adata_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="hc_umap.html">hc_umap</a></span><span class="op">(</span><span class="va">adata_res</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">adata_res</span> <span class="op">&lt;-</span> <span class="fu">hc_cluster_hulls</span><span class="op">(</span><span class="va">adata_res</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">adata_res</span><span class="op">$</span><span class="va">uns</span><span class="op">$</span><span class="va">UMAP_hulls</span><span class="op">$</span><span class="va">hulls</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   cluster sub_cluster sub_type landmass      X     Y polygon_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 7                 1 primary         1 -<span style="color: #BB0000;">0.565</span> 0.432 7_1_1     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 7                 1 primary         1 -<span style="color: #BB0000;">0.572</span> 0.439 7_1_1     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 7                 1 primary         1 -<span style="color: #BB0000;">0.579</span> 0.446 7_1_1     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> 7                 1 primary         1 -<span style="color: #BB0000;">0.572</span> 0.453 7_1_1     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> 7                 1 primary         1 -<span style="color: #BB0000;">0.565</span> 0.46  7_1_1     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> 7                 1 primary         1 -<span style="color: #BB0000;">0.558</span> 0.467 7_1_1     </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Konstantinos Antonopoulos, Maria Bueno Alvez, Emilio Skarwan, Mathias Uhlen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Provided without <strong>any warranty</strong>.</p>
</div>

    </footer></div>





  </body></html>

