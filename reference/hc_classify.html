<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Perform sample category gene classification (HPA logic, sample-agnostic) — hc_classify • HPAclusteR</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Perform sample category gene classification (HPA logic, sample-agnostic) — hc_classify"><meta name="description" content='hc_classify classifies genes based on their expression patterns across different sample categories
using a logic similar to that employed by the Human Protein Atlas (HPA). The function processes
each cluster of genes identified in the AnnDatR object and categorizes them into specificity categories
such as "Enriched", "Group enriched", "Enhanced", and "Low specificity". It also generates pie charts to visualize
the distribution of these categories within each cluster.'><meta property="og:description" content='hc_classify classifies genes based on their expression patterns across different sample categories
using a logic similar to that employed by the Human Protein Atlas (HPA). The function processes
each cluster of genes identified in the AnnDatR object and categorizes them into specificity categories
such as "Enriched", "Group enriched", "Enhanced", and "Low specificity". It also generates pie charts to visualize
the distribution of these categories within each cluster.'><meta property="og:image" content="https://buenoalvezm.github.io/HPAclusteR/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">HPAclusteR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/HPAclusteR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/buenoalvezm/HPAclusteR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Perform sample category gene classification (HPA logic, sample-agnostic)</h1>
      <small class="dont-index">Source: <a href="https://github.com/buenoalvezm/HPAclusteR/blob/master/R/hc_classify.R" class="external-link"><code>R/hc_classify.R</code></a></small>
      <div class="d-none name"><code>hc_classify.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>hc_classify</code> classifies genes based on their expression patterns across different sample categories
using a logic similar to that employed by the Human Protein Atlas (HPA). The function processes
each cluster of genes identified in the AnnDatR object and categorizes them into specificity categories
such as "Enriched", "Group enriched", "Enhanced", and "Low specificity". It also generates pie charts to visualize
the distribution of these categories within each cluster.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hc_classify</span><span class="op">(</span></span>
<span>  <span class="va">AnnDatR</span>,</span>
<span>  <span class="va">sample_categories</span>,</span>
<span>  cutoff_detected <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  lowest_exp_limit <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  group_enriched_limit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fold <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-anndatr">AnnDatR<a class="anchor" aria-label="anchor" href="#arg-anndatr"></a></dt>
<dd><p>AnnDatR object containing gene expression data and sample annotations</p></dd>


<dt id="arg-sample-categories">sample_categories<a class="anchor" aria-label="anchor" href="#arg-sample-categories"></a></dt>
<dd><p>Name of the column in AnnDatR$var containing sample categories</p></dd>


<dt id="arg-cutoff-detected">cutoff_detected<a class="anchor" aria-label="anchor" href="#arg-cutoff-detected"></a></dt>
<dd><p>Expression value threshold to consider a gene as detected (default: 1)</p></dd>


<dt id="arg-lowest-exp-limit">lowest_exp_limit<a class="anchor" aria-label="anchor" href="#arg-lowest-exp-limit"></a></dt>
<dd><p>Minimum expression value to consider for calculations (default: 0.1)</p></dd>


<dt id="arg-group-enriched-limit">group_enriched_limit<a class="anchor" aria-label="anchor" href="#arg-group-enriched-limit"></a></dt>
<dd><p>Maximum number of sample categories for group enriched classification (default: NULL, auto-calculated)</p></dd>


<dt id="arg-fold">fold<a class="anchor" aria-label="anchor" href="#arg-fold"></a></dt>
<dd><p>Fold change threshold for classification (default: 4)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tibble with gene classification results including ENSG, specificity category, specific sample categories, tau value, and distribution category</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Run clustering pipeline</span></span></span>
<span class="r-in"><span><span class="va">adata_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="hc_pca.html">hc_pca</a></span><span class="op">(</span><span class="va">example_adata</span>, components <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">adata_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="hc_distance.html">hc_distance</a></span><span class="op">(</span><span class="va">adata_res</span>, components <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">adata_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="hc_snn.html">hc_snn</a></span><span class="op">(</span><span class="va">adata_res</span>, neighbors <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Building SNN based on a provided distance matrix</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing SNN</span>
<span class="r-in"><span><span class="va">adata_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="hc_cluster_consensus.html">hc_cluster_consensus</a></span><span class="op">(</span><span class="va">adata_res</span>, resolution <span class="op">=</span> <span class="fl">7</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration: 0 *** value: 948.279</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration: 1 *** value: 70.5063</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration: 2 *** value: 22.246</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration: 3 *** value: 22.2447</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Iteration: 4 *** value: 22.2447</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Minimum: 22.2447</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Joining with `by = join_by(cons_cluster)`</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Classify genes based on sample categories</span></span></span>
<span class="r-in"><span><span class="va">gene_classification</span> <span class="op">&lt;-</span> <span class="fu">hc_classify</span><span class="op">(</span><span class="va">adata_res</span>, <span class="st">"tissue_name"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gene_classification</span><span class="op">$</span><span class="va">classification</span><span class="op">[[</span><span class="st">"1"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ENSG            spec_category   spec_sample_categories   tau dist_category   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> ENSG00000072501 Low specificity <span style="color: #BB0000;">NA</span>                      0.35 Detected in all </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> ENSG00000072736 Enhanced        thymus                  0.51 Detected in all </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> ENSG00000077147 Low specificity <span style="color: #BB0000;">NA</span>                      0.28 Detected in all </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> ENSG00000078177 Enhanced        thymus                  0.64 Detected in many</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> ENSG00000100629 Enhanced        thymus                  0.74 Detected in many</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> ENSG00000101868 Enhanced        thymus                  0.51 Detected in many</span>
<span class="r-in"><span><span class="va">gene_classification</span><span class="op">$</span><span class="va">pie_charts</span><span class="op">[[</span><span class="st">"1"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-plt img"><img src="hc_classify-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Konstantinos Antonopoulos, Maria Bueno Alvez, Emilio Skarwan, Mathias Uhlen.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Provided without <strong>any warranty</strong>.</p>
</div>

    </footer></div>





  </body></html>

