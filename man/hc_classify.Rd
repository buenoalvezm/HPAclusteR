% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hc_classify.R
\name{hc_classify}
\alias{hc_classify}
\title{Perform sample category gene classification (HPA logic, sample-agnostic)}
\usage{
hc_classify(
  AnnDatR,
  sample_categories,
  cutoff_detected = 1,
  lowest_exp_limit = 0.1,
  group_enriched_limit = NULL,
  fold = 4
)
}
\arguments{
\item{AnnDatR}{AnnDatR object containing gene expression data and sample annotations}

\item{sample_categories}{Name of the column in AnnDatR$var containing sample categories}

\item{cutoff_detected}{Expression value threshold to consider a gene as detected (default: 1)}

\item{lowest_exp_limit}{Minimum expression value to consider for calculations (default: 0.1)}

\item{group_enriched_limit}{Maximum number of sample categories for group enriched classification (default: NULL, auto-calculated)}

\item{fold}{Fold change threshold for classification (default: 4)}
}
\value{
A tibble with gene classification results including ENSG, specificity category, specific sample categories, tau value, and distribution category
}
\description{
\code{hc_classify} classifies genes based on their expression patterns across different sample categories
using a logic similar to that employed by the Human Protein Atlas (HPA). The function processes
each cluster of genes identified in the AnnDatR object and categorizes them into specificity categories
such as "Enriched", "Group enriched", "Enhanced", and "Low specificity". It also generates pie charts to visualize
the distribution of these categories within each cluster.
}
\examples{
# Run clustering pipeline
adata_res <- hc_pca(example_adata, components = 40)
adata_res <- hc_distance(adata_res, components = 20)
adata_res <- hc_snn(adata_res, neighbors = 15)
adata_res <- hc_cluster_consensus(adata_res, resolution = 7)

# Classify genes based on sample categories
gene_classification <- hc_classify(adata_res, "tissue_name")
head(gene_classification$classification[["1"]])
gene_classification$pie_charts[["1"]]
}
