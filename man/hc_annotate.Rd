% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/hc_annotate.R
\name{hc_annotate}
\alias{hc_annotate}
\title{Master annotation pipeline: download, load, and run all enrichments}
\usage{
hc_annotate(
  AnnDatR,
  dbs = c("GO", "KEGG", "Others"),
  universe = NULL,
  db_loc = "databases",
  hpa_version = 24,
  verbose = TRUE
)
}
\arguments{
\item{AnnDatR}{AnnDatR object containing clustering results}

\item{dbs}{Character vector of databases to use for enrichment ("GO", "KEGG", "Others") (default: all)}

\item{universe}{Character vector of background genes (default: NULL, all genes in clustering data)}

\item{db_loc}{Directory to store annotation databases (default: "databases")}

\item{hpa_version}{Version of the Human Protein Atlas to download (default: 24)}

\item{verbose}{Logical, print progress messages (default: TRUE)}
}
\value{
A named list with elements:
\itemize{
\item enrichment: Data frame with combined enrichment results from all selected databases
\item treemaps: List of ggplot objects with GO treemaps per cluster (if GO selected)
\item bubblemap_go: ggplot object with GO enrichment bubblemap (if GO selected)
\item bubblemap_kegg: ggplot object with KEGG enrichment bubblemap (if KEGG selected)
\item bubblemap_others: ggplot object with custom database enrichment bubblemap (if Others selected)
}
}
\description{
\code{hc_annotate()} is a master function that performs functional enrichment analysis. It downloads necessary annotation databases,
formats them, and runs enrichment analyses for Gene Ontology (GO), KEGG pathways, and custom databases (Human Protein Atlas, Reactome, TRRUST, PanglaoDB)
based on the clustering results stored in the AnnDatR object. It also generates visualizations such as treemaps for GO terms and bubblemaps for all enrichment results.
}
\details{
In case some of the databases did not download correctly, please rerun the function.
If that does not help, please manually download the databases, place them in the specified db_loc directory and unzip the zipped files.
Links:
\itemize{
\item Human Protein Atlas version 24: https://v\%d.proteinatlas.org/download/proteinatlas.tsv.zip
\item Reactome: https://reactome.org/download/current/Ensembl2Reactome_All_Levels.txt
\item Trrust: https://www.grnpedia.org/trrust/data/trrust_rawdata.human.tsv
\item Panglao: https://panglaodb.se/markers/PanglaoDB_markers_27_Mar_2020.tsv.gz
}

Or just run the annotation only using KEGG and GO by setting dbs = c("KEGG", "GO").

This function will require time depending on the size of the dataset and the number of clusters, especially if GO is included.
Set verbose = TRUE to monitor the progress.

For the bubblemaps, the odds ratio is capped at 50 for better visualization. Also, only the top 150 terms (by mean odds ratio across clusters) are shown.
}
\examples{
# Run clustering pipeline
adata_res <- hc_pca(example_adata, components = 40)
adata_res <- hc_distance(adata_res, components = 20)
adata_res <- hc_snn(adata_res, neighbors = 15)
adata_res <- hc_cluster_consensus(adata_res, resolution = 7)

# Run annotation pipeline
enrichment_results <- hc_annotate(adata_res, dbs = "KEGG")
head(enrichment_results$enrichment)
}
