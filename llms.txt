# HPAclusteR

`HPAclusteR` is an R package developed by the **Human Protein Atlas** to
perform **gene clustering** from transcriptomics data. The package
provides a complete pipeline for clustering genes, visualizing
clustering results, and annotating gene clusters with functional
databases such as **Gene Ontology** and others. It is designed to
facilitate the analysis of transcriptomics data and help researchers
identify biologically meaningful gene clusters.

> Note: This package is built to work with `AnnDatR` objects, which are
> designed to handle transcriptomics data efficiently. The package that
> conceptualizes this data structure can be found
> [here](https://github.com/emiliosk/AnnDatR).

## Features

### Gene Clustering Pipeline:

- Perform PCA for dimensionality reduction.
- Calculate distances between genes.
- Construct Shared Nearest Neighbor (SNN) graphs.
- Perform consensus clustering to identify robust gene clusters.
- Generate UMAP embeddings for visualization.
- Create UMAP cluster hulls to highlight cluster boundaries.

### Annotate Gene Clusters with Functional Databases:

- Gene Ontology (GO)
- KEGG Pathways
- Humnan Protein Atlas (HPA)
  - Tissue Expression
  - Single Cell Type Expression
  - Blood Expression
  - Brain Expression
  - Subcellular Location
  - Secretome Location
  - Protein Class
- Reactome Pathways
- PanglaoDB Cell Markers
- Trrusted Cell Markers

### Ready-to-use Visualization Functions:

- Plot UMAP embeddings with clusters and/or hulls.
- Plot gene expression per cluster across samples.
- Plot annotation results with treemaps and buble heatmaps.
- Plot cluster comparison results with network graphs.

## Installation

You can install the development version of `HPAclusteR` from GitHub:

``` r
# Install devtools if not already installed
install.packages("devtools")

# Install HPAclusteR
devtools::install_github("buenoalvezm/HPAclusteR")
```

## Usage

Start right away with the
[`hc_auto_cluster()`](https://buenoalvezm.github.io/HPAclusteR/reference/hc_auto_cluster.md)
function, which performs the complete gene clustering pipeline on an
`AnnDatR` object.

``` r
library(HPAclusteR)

# Example input: AnnDatR object with transcriptomics data
adata_res <- hc_auto_cluster(example_adata, cluster_resolution = 10)
```

## Issues and Support

If you encounter any bugs or you want to recommend new features and
changes to existing ones, please open a [new
issue](https://github.com/buenoalvezm/HPAclusteR/issues) on our GitHub
repository.

## Contact

For any questions or further information, please contact us at
<k.antono@outlook.com>.

# Package index

## Utilities

General utility functions.

- [`hc_initialize()`](https://buenoalvezm.github.io/HPAclusteR/reference/hc_initialize.md)
  : Initialize AnnDatR object for gene clustering (genes as samples)

## Workflows

Functions for complete, one-call workflows.

- [`hc_auto_cluster()`](https://buenoalvezm.github.io/HPAclusteR/reference/hc_auto_cluster.md)
  : One-call clustering pipeline

## Clustering Pipeline

Functions for gene clustering.

- [`hc_pca()`](https://buenoalvezm.github.io/HPAclusteR/reference/hc_pca.md)
  : Perform PCA on AnnDatR object
- [`hc_kaisers_rule()`](https://buenoalvezm.github.io/HPAclusteR/reference/hc_kaisers_rule.md)
  : Determine number of components using Kaiser's rule
- [`hc_distance()`](https://buenoalvezm.github.io/HPAclusteR/reference/hc_distance.md)
  : Compute distance matrix from PCA scores
- [`hc_snn()`](https://buenoalvezm.github.io/HPAclusteR/reference/hc_snn.md)
  : Compute Shared Nearest Neighbors (SNN) Graph
- [`hc_cluster_consensus()`](https://buenoalvezm.github.io/HPAclusteR/reference/hc_cluster_consensus.md)
  : Consensus clustering of genes
- [`hc_umap()`](https://buenoalvezm.github.io/HPAclusteR/reference/hc_umap.md)
  : Create UMAP embeddings from SNN graph
- [`hc_cluster_hulls()`](https://buenoalvezm.github.io/HPAclusteR/reference/hc_cluster_hulls.md)
  : Calculate UMAP cluster hulls

## Clustering Evaluation

Functions for evaluating clustering results.

- [`hc_cluster_stability()`](https://buenoalvezm.github.io/HPAclusteR/reference/hc_cluster_stability.md)
  : Calculate ARI scores for multiple clustering seeds
- [`hc_cluster_compare()`](https://buenoalvezm.github.io/HPAclusteR/reference/hc_cluster_compare.md)
  : Compare clusters using hypergeometric test

## Cluster Annotation

Functions for annotating clusters with functional databases.

- [`hc_annotate()`](https://buenoalvezm.github.io/HPAclusteR/reference/hc_annotate.md)
  : Master annotation pipeline: download, load, and run all enrichments
- [`hc_classify()`](https://buenoalvezm.github.io/HPAclusteR/reference/hc_classify.md)
  : Perform sample category gene classification (HPA logic,
  sample-agnostic)

## Visualization

Functions for visualizing clustering results.

- [`hc_plot_umap()`](https://buenoalvezm.github.io/HPAclusteR/reference/hc_plot_umap.md)
  : Plot UMAP with clusters and hulls
- [`hc_plot_expression()`](https://buenoalvezm.github.io/HPAclusteR/reference/hc_plot_expression.md)
  : Plot per-cluster heatmaps for scaled and z-score expression
- [`theme_hc()`](https://buenoalvezm.github.io/HPAclusteR/reference/theme_hc.md)
  : A simple theme for visualizations

## Built in datasets

Datasets included with the package for demonstration and testing
purposes.

- [`example_adata`](https://buenoalvezm.github.io/HPAclusteR/reference/example_adata.md)
  : Human Protein Atlas Tissue Data (transposed and subsampled)

# Articles

### All vignettes

- [HPAclusteR](https://buenoalvezm.github.io/HPAclusteR/articles/HPAclusteR.md):
